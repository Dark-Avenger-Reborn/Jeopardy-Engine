<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Jeopardy Engine</title>
  <style>
    /* General Reset */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Arial', sans-serif;
      background-color: #212121; /* Dark background */
      color: #fff; /* White text for contrast */
      padding: 20px;
    }

    h1 {
      text-align: center;
      margin-bottom: 20px;
      color: #fff;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      table-layout: fixed; /* Ensures consistent column widths */
      background-color: #333; /* Dark table background */
      border-radius: 8px;
      overflow: hidden;
      margin: auto;
    }

    thead th {
      background-color: #444; /* Slightly lighter dark for headers */
      color: #fff;
      padding: 10px;
      font-size: 14px;
      text-align: center;
    }

    tbody td {
      padding: 8px;
      text-align: center;
      font-size: 13px;
      border: 1px solid #555; /* Subtle border between cells */
      transition: background-color 0.3s ease;
    }

    tbody th {
      background-color: #444;
      color: #fff;
      padding: 10px;
      text-align: left;
      font-size: 14px;
      border-right: 1px solid #555;
    }

    /* Green Background */
    .green {
      background-color: #1b5e20; /* Vibrant green */
      color: #fff;
    }
    
    .red {
      background-color: #FF0000; /* Vibrant red */
      color: #fff;
    }

    /* Checkbox Styling */
    .styled-checkbox {
      position: relative;
      width: 18px;
      height: 18px;
      cursor: pointer;
      appearance: none;
      border: 2px solid #888;
      border-radius: 4px;
      background-color: #444;
      transition: all 0.3s ease;
    }

    .styled-checkbox:checked {
      background-color: #444;
      border-color: #888;
      position: relative;
    }

    .styled-checkbox:checked::after {
      content: "âœ”";
      font-size: 14px;
      color: #fff;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
    
    /* Add this new style for IP checkboxes */
    .ip-checkbox {
      margin-right: 5px;
      vertical-align: middle;
    }

    /* Adjust cell padding to accommodate the checkbox */
    tbody td {
      padding: 8px 4px;
      text-align: left; /* Change to left alignment */
    }    

    /* Dark Theme Scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: #212121;
    }

    ::-webkit-scrollbar-thumb {
      background: #555;
    }

    /* Responsive Table */
    @media (max-width: 768px) {
      table {
        font-size: 12px;
      }

      thead th {
        font-size: 12px;
        padding: 8px;
      }

      tbody td, tbody th {
        padding: 6px;
        font-size: 11px;
      }
    }
  </style>
</head>
<body>
  <h1>System Status Dashboard</h1>
  <table>
    <thead>
      <tr>
        <th></th>
        <th>AD: DNS <input class="styled-checkbox top-checkbox" type="checkbox" data-column="1"></th>
        <th>AD: LDAP <input class="styled-checkbox top-checkbox" type="checkbox" data-column="2"></th>
        <th>Backup: HTTP <input class="styled-checkbox top-checkbox" type="checkbox" data-column="3"></th>
        <th>DevServer: PING <input class="styled-checkbox top-checkbox" type="checkbox" data-column="4"></th>
        <th>DevServer: SSH <input class="styled-checkbox top-checkbox" type="checkbox" data-column="5"></th>
        <th>FTP: FTP <input class="styled-checkbox top-checkbox" type="checkbox" data-column="6"></th>
        <th>Ubuntu1: PING <input class="styled-checkbox top-checkbox" type="checkbox" data-column="7"></th>
        <th>Ubuntu1: SSH <input class="styled-checkbox top-checkbox" type="checkbox" data-column="8"></th>
        <th>Ubuntu2: PING <input class="styled-checkbox top-checkbox" type="checkbox" data-column="9"></th>
        <th>Ubuntu2: SSH <input class="styled-checkbox top-checkbox" type="checkbox" data-column="10"></th>
        <th>WebApp: HTTP <input class="styled-checkbox top-checkbox" type="checkbox" data-column="11"></th>
        <th>WebApp: SQL <input class="styled-checkbox top-checkbox" type="checkbox" data-column="12"></th>
        <th>Windows1: PING <input class="styled-checkbox top-checkbox" type="checkbox" data-column="13"></th>
        <th>Windows1: WINRM <input class="styled-checkbox top-checkbox" type="checkbox" data-column="14"></th>
        <th>Windows2: PING <input class="styled-checkbox top-checkbox" type="checkbox" data-column="15"></th>
        <th>Windows2: WINRM <input class="styled-checkbox top-checkbox" type="checkbox" data-column="16"></th>
      </tr>
    </thead>
    <tbody id="team-rows">
      <!-- Rows will be inserted dynamically here -->
    </tbody>
  </table>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const teams = [
        {
          name: "Team 01",
          ipAddresses: [
            "10.1.1.60", "10.1.1.60:389", "10.1.2.2:80", "10.1.2.10", "10.1.2.10:22",
            "10.1.2.4:21", "10.1.1.10", "10.1.1.10:22", "10.1.1.40", "10.1.1.40:22",
            "10.1.1.30:80", "10.1.1.30:3306", "10.1.1.70", "10.1.1.70:5985", "10.1.1.80", "10.1.1.80:5985"
          ]
        },
        {
          name: "Team 02",
          ipAddresses: [
            "10.2.1.60", "10.2.1.60:389", "10.2.2.2:80", "10.2.2.10", "10.2.2.10:22",
            "10.2.2.4:21", "10.2.1.10", "10.2.1.10:22", "10.2.1.40", "10.2.1.40:22",
            "10.2.1.30:80", "10.2.1.30:3306", "10.2.1.70", "10.2.1.70:5985", "10.2.1.80", "10.2.1.80:5985"
          ]
        },
        {
          name: "Team 03",
          ipAddresses: [
            "10.3.1.60", "10.3.1.60:389", "10.3.2.2:80", "10.3.2.10", "10.3.2.10:22",
            "10.3.2.4:21", "10.3.1.10", "10.3.1.10:22", "10.3.1.40", "10.3.1.40:22",
            "10.3.1.30:80", "10.3.1.30:3306", "10.3.1.70", "10.3.1.70:5985", "10.3.1.80", "10.3.1.80:5985"
          ]
        },
        {
          name: "Team 04",
          ipAddresses: [
            "10.4.1.60", "10.4.1.60:389", "10.4.2.2:80", "10.4.2.10", "10.4.2.10:22",
            "10.4.2.4:21", "10.4.1.10", "10.4.1.10:22", "10.4.1.40", "10.4.1.40:22",
            "10.4.1.30:80", "10.4.1.30:3306", "10.4.1.70", "10.4.1.70:5985", "10.4.1.80", "10.4.1.80:5985"
          ]
        },
        {
          name: "Team 05",
          ipAddresses: [
            "10.5.1.60", "10.5.1.60:389", "10.5.2.2:80", "10.5.2.10", "10.5.2.10:22",
            "10.5.2.4:21", "10.5.1.10", "10.5.1.10:22", "10.5.1.40", "10.5.1.40:22",
            "10.5.1.30:80", "10.5.1.30:3306", "10.5.1.70", "10.5.1.70:5985", "10.5.1.80", "10.5.1.80:5985"
          ]
        },
        {
          name: "Team 06",
          ipAddresses: [
            "10.6.1.60", "10.6.1.60:389", "10.6.2.2:80", "10.6.2.10", "10.6.2.10:22",
            "10.6.2.4:21", "10.6.1.10", "10.6.1.10:22", "10.6.1.40", "10.6.1.40:22",
            "10.6.1.30:80", "10.6.1.30:3306", "10.6.1.70", "10.6.1.70:5985", "10.6.1.80", "10.6.1.80:5985"
          ]
        },
        {
          name: "Team 07",
          ipAddresses: [
            "10.7.1.60", "10.7.1.60:389", "10.7.2.2:80", "10.7.2.10", "10.7.2.10:22",
            "10.7.2.4:21", "10.7.1.10", "10.7.1.10:22", "10.7.1.40", "10.7.1.40:22",
            "10.7.1.30:80", "10.7.1.30:3306", "10.7.1.70", "10.7.1.70:5985", "10.7.1.80", "10.7.1.80:5985"
          ]
        },
        {
          name: "Team 08",
          ipAddresses: [
            "10.8.1.60", "10.8.1.60:389", "10.8.2.2:80", "10.8.2.10", "10.8.2.10:22",
            "10.8.2.4:21", "10.8.1.10", "10.8.1.10:22", "10.8.1.40", "10.8.1.40:22",
            "10.8.1.30:80", "10.8.1.30:3306", "10.8.1.70", "10.8.1.70:5985", "10.8.1.80", "10.8.1.80:5985"
          ]
        },
        {
          name: "Team 09",
          ipAddresses: [
            "10.9.1.60", "10.9.1.60:389", "10.9.2.2:80", "10.9.2.10", "10.9.2.10:22",
            "10.9.2.4:21", "10.9.1.10", "10.9.1.10:22", "10.9.1.40", "10.9.1.40:22",
            "10.9.1.30:80", "10.9.1.30:3306", "10.9.1.70", "10.9.1.70:5985", "10.9.1.80", "10.9.1.80:5985"
          ]
        },
        {
          name: "Team 10",
          ipAddresses: [
            "10.10.1.60", "10.10.1.60:389", "10.10.2.2:80", "10.10.2.10", "10.10.2.10:22",
            "10.10.2.4:21", "10.10.1.10", "10.10.1.10:22", "10.10.1.40", "10.10.1.40:22",
            "10.10.1.30:80", "10.10.1.30:3306", "10.10.1.70", "10.10.1.70:5985", "10.10.1.80", "10.10.1.80:5985"
          ]
        },
        {
          name: "Team 11",
          ipAddresses: [
            "10.11.1.60", "10.11.1.60:389", "10.11.2.2:80", "10.11.2.10", "10.11.2.10:22",
            "10.11.2.4:21", "10.11.1.10", "10.11.1.10:22", "10.11.1.40", "10.11.1.40:22",
            "10.11.1.30:80", "10.11.1.30:3306", "10.11.1.70", "10.11.1.70:5985", "10.11.1.80", "10.11.1.80:5985"
          ]
        },
        {
          name: "Team 12",
          ipAddresses: [
            "10.12.1.60", "10.12.1.60:389", "10.12.2.2:80", "10.12.2.10", "10.12.2.10:22",
            "10.12.2.4:21", "10.12.1.10", "10.12.1.10:22", "10.12.1.40", "10.12.1.40:22",
            "10.12.1.30:80", "10.12.1.30:3306", "10.12.1.70", "10.12.1.70:5985", "10.12.1.80", "10.12.1.80:5985"
          ]
        },
        {
          name: "Team 13",
          ipAddresses: [
            "10.13.1.60", "10.13.1.60:389", "10.13.2.2:80", "10.13.2.10", "10.13.2.10:22",
            "10.13.2.4:21", "10.13.1.10", "10.13.1.10:22", "10.13.1.40", "10.13.1.40:22",
            "10.13.1.30:80", "10.13.1.30:3306", "10.13.1.70", "10.13.1.70:5985", "10.13.1.80", "10.13.1.80:5985"
          ]
        },
        {
          name: "Team 14",
          ipAddresses: [
            "10.14.1.60", "10.14.1.60:389", "10.14.2.2:80", "10.14.2.10", "10.14.2.10:22",
            "10.14.2.4:21", "10.14.1.10", "10.14.1.10:22", "10.14.1.40", "10.14.1.40:22",
            "10.14.1.30:80", "10.14.1.30:3306", "10.14.1.70", "10.14.1.70:5985", "10.14.1.80", "10.14.1.80:5985"
          ]
        },
        {
          name: "Team 15",
          ipAddresses: [
            "10.15.1.60", "10.15.1.60:389", "10.15.2.2:80", "10.15.2.10", "10.15.2.10:22",
            "10.15.2.4:21", "10.15.1.10", "10.15.1.10:22", "10.15.1.40", "10.15.1.40:22",
            "10.15.1.30:80", "10.15.1.30:3306", "10.15.1.70", "10.15.1.70:5985", "10.15.1.80", "10.15.1.80:5985"
          ]
        }
      ];

      const teamRows = document.getElementById("team-rows");

      // Generate table rows for each team
      teams.forEach((team, index) => {
        let row = `<tr>
          <th>Team ${index + 1} <input class="styled-checkbox row-checkbox" type="checkbox" data-row="${index + 1}"></th>`;

        // Generate a table cell for each IP address
        team.ipAddresses.forEach(ip => {
          row += `<td class="green"><input class="styled-checkbox ip-checkbox" type="checkbox"><span>${ip}</span></td>`;
        });

        row += `</tr>`;
        teamRows.innerHTML += row;
      });

      // Column checkboxes
      document.querySelectorAll('thead input[type="checkbox"]').forEach((checkbox) => {
        checkbox.addEventListener("change", () => {
          const columnIndex = checkbox.dataset.column;
          const isChecked = checkbox.checked;
          document.querySelectorAll(`tbody td:nth-child(${parseInt(columnIndex) + 1})`).forEach(cell => {
            cell.className = isChecked ? "red" : "green";
            cell.querySelector('.ip-checkbox').checked = isChecked;
          });
        });
      });

      // Row checkboxes
      document.querySelectorAll('tbody input.row-checkbox').forEach((checkbox) => {
        checkbox.addEventListener("change", () => {
          const isChecked = checkbox.checked;
          const row = checkbox.closest('tr');
          row.querySelectorAll('td').forEach(cell => {
            cell.className = isChecked ? "red" : "green";
            cell.querySelector('.ip-checkbox').checked = isChecked;
          });
        });
      });

      // IP checkboxes
      document.querySelectorAll('tbody input.ip-checkbox').forEach((checkbox) => {
        checkbox.addEventListener("change", () => {
          const cell = checkbox.closest('td');
          cell.className = checkbox.checked ? "red" : "green";
        });
      });
    });



    document.addEventListener("DOMContentLoaded", () => {
      // Collect all checkbox states and send to the server
      const getCheckedData = () => {
        const checkedData = [];

        // Collect row-level data (team data)
        document.querySelectorAll('tbody tr').forEach((row, rowIndex) => {
          const rowData = {
            teamName: row.querySelector('th').textContent.trim(),
            rowChecked: row.querySelector('.row-checkbox').checked,
            ipStates: []
          };

          // Collect IP checkbox states for each row (team) across all columns
          row.querySelectorAll('td').forEach((cell, colIndex) => {
            const ipAddress = cell.querySelector('span') ? cell.querySelector('span').textContent.trim() : null;
            const checkbox = cell.querySelector('.ip-checkbox');
            
            if (ipAddress && checkbox) {
              rowData.ipStates.push({
                ip: ipAddress,
                isChecked: checkbox.checked,
                columnIndex: colIndex + 1 // This ensures correct mapping to columns (1-based index)
              });
            }
          });

          checkedData.push(rowData);
        });

        return checkedData;
      };

      // Function to send data to Flask server
      const sendDataToServer = async () => {
        const data = getCheckedData();

        try {
          const response = await fetch('/update_status', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify(data), // Sending JSON data
          });

          if (response.ok) {
            const jsonResponse = await response.json();
            console.log('Server Response:', jsonResponse);
          } else {
            console.error('Error sending data to server');
          }
        } catch (error) {
          console.error('Error sending data to server:', error);
        }
      };

      // Event listener for individual checkbox changes (IP checkboxes and row checkboxes)
      document.querySelectorAll('input[type="checkbox"]').forEach((checkbox) => {
        checkbox.addEventListener('change', () => {
          sendDataToServer(); // Send data each time a checkbox is changed
        });
      });
    });
  </script>
</body>
</html>
